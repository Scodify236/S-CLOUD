<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S-CLOUD</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
/* Base styles */
/* Base styles */
/* Base styles */
/* Base styles */
:root {
  --primary-bg: rgba(15, 23, 42, 0.8);
  --secondary-bg: rgba(30, 41, 59, 0.8);
  --primary-text: #e2e8f0;
  --secondary-text: #94a3b8;
  --accent-color: #3b82f6;
  --hover-accent: #2563eb;
}

body {
  background-image: url('https://source.unsplash.com/random/1920x1080?abstract');
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  color: var(--primary-text);
  font-family: 'Inter', sans-serif;
  margin: 0;
  padding: 0;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  font-size: 16px;
  line-height: 1.6;
}

.gradient-background {
  background: linear-gradient(135deg, rgba(30, 41, 59, 0.7), rgba(15, 23, 42, 0.7));
}

/* Container styles */
.search-container, .results-container {
  background-color: rgba(30, 41, 59, 0.6);
  backdrop-filter: blur(12px);
  border-radius: 16px;
  padding: 2rem;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  transition: all 0.3s ease;
  margin-bottom: 1.5rem;
  border: 1px solid rgba(59, 130, 246, 0.2);
}

.search-container:hover, .results-container:hover {
  box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
  transform: translateY(-3px);
}

/* Player styles */
.player {
  background-color: rgba(15, 23, 42, 0.85);
  border-top-left-radius: 16px;
  border-top-right-radius: 16px;
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 1.5rem 2rem;
  height: 90px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  z-index: 1000;
  border-top: 1px solid rgba(59, 130, 246, 0.2);
  backdrop-filter: blur(8px);
}

.progress-bar {
  background-color: rgba(51, 65, 85, 0.5);
  cursor: pointer;
  height: 4px;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  border-top-left-radius: 16px;
  border-top-right-radius: 16px;
  overflow: hidden;
}

.progress {
  background-color: var(--accent-color);
  height: 100%;
  border-top-left-radius: 16px;
  transition: width 0.1s linear;
  position: relative;
}

.progress::after {
  content: '';
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  width: 8px;
  background: linear-gradient(90deg, transparent, #60a5fa);
}

/* Button styles */
.control-button {
  background-color: rgba(59, 130, 246, 0.8);
  transition: all 0.3s;
  border-radius: 50%;
  width: 48px;
  height: 48px;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
  border: none;
  cursor: pointer;
}

.control-button:hover {
  background-color: rgba(37, 99, 235, 0.9);
  transform: scale(1.05);
  box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4);
}

/* Song container styles */
.song-container {
  transition: all 0.3s;
  background-color: rgba(59, 130, 246, 0.1);
  border-radius: 12px;
  margin-bottom: 1rem;
  padding: 1.5rem;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  border: 1px solid rgba(59, 130, 246, 0.1);
}

.song-container:hover {
  background-color: rgba(59, 130, 246, 0.2);
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
}

/* Scrollbar styles */
.custom-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: rgba(75, 85, 99, 0.6) rgba(31, 41, 55, 0.4);
}

.custom-scrollbar::-webkit-scrollbar {
  width: 6px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: rgba(31, 41, 55, 0.4);
  border-radius: 3px;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background-color: rgba(75, 85, 99, 0.6);
  border-radius: 3px;
  border: 2px solid rgba(31, 41, 55, 0.4);
}

/* Lofi toggle styles */
.lofi-toggle {
  background-color: rgba(75, 85, 99, 0.6);
  transition: all 0.3s;
  border-radius: 12px;
  padding: 2px;
  width: 52px;
  height: 28px;
  display: flex;
  align-items: center;
  cursor: pointer;
}

.lofi-toggle.active {
  background-color: var(--accent-color);
}

.lofi-toggle-knob {
  background-color: rgba(226, 232, 240, 0.9);
  transition: all 0.3s;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

/* Header styles */
header {
  background-color: rgba(15, 23, 42, 0.85);
  color: var(--primary-text);
  padding: 1.5rem 2rem;
  border-bottom-left-radius: 16px;
  border-bottom-right-radius: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  display: flex;
  align-items: center;
  margin-bottom: 2rem;
  backdrop-filter: blur(8px);
}

header img {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid var(--accent-color);
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
  margin-right: 1rem;
}

/* Form element styles */
input[type="text"], select {
  background-color: rgba(31, 41, 55, 0.6);
  border: 2px solid rgba(75, 85, 99, 0.6);
  color: var(--primary-text);
  border-radius: 12px;
  padding: 0.75rem 1rem;
  transition: all 0.3s;
  font-size: 1rem;
  width: 100%;
  margin-bottom: 1rem;
}

input[type="text"]:focus, select:focus {
  border-color: var(--accent-color);
  outline: none;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
}

button {
  background-color: rgba(59, 130, 246, 0.8);
  color: var(--primary-text);
  transition: all 0.3s;
  border-radius: 12px;
  padding: 0.75rem 1.5rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
  border: none;
  cursor: pointer;
}

button:hover {
  background-color: rgba(37, 99, 235, 0.9);
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4);
}

/* Player info styles */
#player-name {
  color: var(--primary-text);
  font-weight: 600;
  font-size: 1.1rem;
  margin-bottom: 0.25rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 220px;
}

#player-album {
  color: var(--secondary-text);
  font-size: 0.9rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 220px;
}

#player-image {
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
  border-radius: 8px;
  width: 64px;
  height: 64px;
  object-fit: cover;
  transition: all 0.3s ease;
}

#player-image:hover {
  transform: scale(1.05);
  box-shadow: 0 12px 32px rgba(0, 0, 0, 0.4);
}

/* Load more button styles */
#loadmore {
  background-color: rgba(59, 130, 246, 0.8);
  color: var(--primary-text);
  transition: all 0.3s;
  border-radius: 12px;
  padding: 0.75rem 1.5rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-top: 2rem;
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
  display: block;
  width: 100%;
}

#loadmore:hover {
  background-color: rgba(37, 99, 235, 0.9);
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4);
}

/* Main content area */
main {
  flex-grow: 1;
  padding: 1.5rem;
  margin-bottom: 100px; /* Adjusted for increased player height */
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
  font-weight: 700;
  letter-spacing: -0.025em;
  margin-bottom: 1rem;
}

h1 { font-size: 2.5rem; }
h2 { font-size: 2rem; }
h3 { font-size: 1.75rem; }
h4 { font-size: 1.5rem; }
h5 { font-size: 1.25rem; }
h6 { font-size: 1rem; }

/* Subtle text shadow for better readability */
#player-name, #player-album {
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
}

/* Animations */
@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

.control-button:active {
  animation: pulse 0.3s ease-in-out;
}

/* Responsive design */
@media (max-width: 768px) {
  .player {
    flex-direction: column;
    height: auto;
    padding: 0.75rem 1.5rem;
  }

  #player-image {
    width: 56px;
    height: 56px;
  }

  #player-name, #player-album {
    max-width: 180px;
  }

  .control-button {
    width: 44px;
    height: 44px;
  }

  .lofi-toggle {
    width: 48px;
    height: 26px;
  }

  .lofi-toggle-knob {
    width: 22px;
    height: 22px;
  }

  .search-container, .results-container {
    padding: 1.5rem;
  }

  header {
    padding: 1rem 1.5rem;
  }
}

/* Additional enhancements */
::selection {
  background-color: rgba(59, 130, 246, 0.3);
}

.fade-in {
  animation: fadeIn 0.5s ease-in-out;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.song-container, .search-container, .results-container {
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.song-container:active, .search-container:active, .results-container:active {
  transform: scale(0.98);
}

/* Glass morphism effect */
.glass-effect {
  background: rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

/* Enhance hover effects */
.song-container:hover, .search-container:hover, .results-container:hover {
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  transform: translateY(-4px);
}

/* Add subtle animations */
@keyframes float {
  0% { transform: translateY(0px); }
  50% { transform: translateY(-5px); }
  100% { transform: translateY(0px); }
}

.float-animation {
  animation: float 4s ease-in-out infinite;
}
</style>
</head>
<body class="min-h-screen flex flex-col gradient-background">
    <header class="p-4 flex items-center">
        <img src="logo.webp" alt="S-CLOUD Logo" class="w-8 h-8 mr-2">
        <h1 class="text-2xl font-bold">S-CLOUD</h1>
    </header>

    <main class="flex-grow p-4">
        <div class="search-container rounded-lg p-4 mb-4 shadow-lg">
            <form id="search-form" class="flex">
                <input type="text" id="saavn-search-box" placeholder="Search for songs..." class="flex-grow p-2 rounded-l-lg text-black focus:outline-none focus:ring-2 focus:ring-blue-500">
                <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-r-lg transition duration-300">Search</button>
            </form>
            <select id="saavn-bitrate" class="mt-2 p-2 rounded text-black focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="4">320 kbps</option>
                <option value="3">160 kbps</option>
            </select>
            <button id="loadmore" class="mt-4 bg-blue-500 hover:bg-blue-600 text-white p-2 rounded transition duration-300 shadow">Load More</button>
        </div>

        <div id="saavn-results" class="results-container rounded-lg p-4 overflow-y-auto custom-scrollbar shadow-lg" style="max-height: 60vh;"></div>

        
    </main>

    <footer class="player fixed bottom-0 left-0 right-0 p-4 shadow-lg">
        <div class="flex items-center justify-between">
            <div class="flex items-center">
                <img id="player-image" src="/api/placeholder/64/64" alt="Album cover" class="w-16 h-16 rounded-full mr-4 shadow-md">
                <div>
                    <p id="player-name" class="font-semibold">Song Name</p>
                    <p id="player-album" class="text-sm text-gray-400">Album Name</p>
                </div>
            </div>
            <div class="flex-grow mx-4">
                <div class="flex justify-center items-center mb-2">
                    <button id="play-pause" class="control-button rounded-full p-2 mr-4">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" />
                        </svg>
                    </button>
                    <div class="lofi-toggle w-12 h-6 rounded-full flex items-center p-1 cursor-pointer">
                        <div class="lofi-toggle-knob w-4 h-4 rounded-full"></div>
                    </div>
                    <span class="ml-2 text-sm">Lofi</span>
                </div>
                <div id="progress-container" class="progress-bar w-full h-2 rounded-full">
                    <div id="progress" class="progress h-full rounded-full" style="width: 0%"></div>
                </div>
                <div class="flex justify-between text-xs mt-1">
                    <span id="current-time">0:00</span>
                    <span id="duration">0:00</span>
                </div>
            </div>
        </div>
    </footer>

    <audio id="player" crossorigin="anonymous">
        <source id="audioSource" src="" type="audio/mp3">
    </audio>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web-audio-api/2.0.0/audioworklet.min.js"></script>
    <script src="assets/js/functions.js"></script>
    <script src="assets/js/saavn-search.js"></script>
    <script>
let audioContext;
let sourceNode;
let reverbNode;
let slowedReverbEnabled = false;

const audio = document.getElementById('player');
const progressBar = document.getElementById('progress-container');
const progress = document.getElementById('progress');
const currentTimeElement = document.getElementById('current-time');
const durationElement = document.getElementById('duration');
const slowedReverbToggle = document.querySelector('.lofi-toggle');

document.getElementById('search-form').addEventListener('submit', function(event) {
    event.preventDefault();
    SaavnSearch();
});

document.getElementById('play-pause').addEventListener('click', togglePlayPause);

audio.addEventListener('timeupdate', updateProgress);
audio.addEventListener('loadedmetadata', () => {
    durationElement.textContent = formatTime(audio.duration);
});

progressBar.addEventListener('click', seek);

slowedReverbToggle.addEventListener('click', toggleSlowedReverb);

function togglePlayPause() {
    if (audio.paused) {
        audio.play();
        updatePlayPauseButton(true);
    } else {
        audio.pause();
        updatePlayPauseButton(false);
    }
}

function updatePlayPauseButton(isPlaying) {
    const button = document.getElementById('play-pause');
    button.innerHTML = isPlaying
        ? '<svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z" clip-rule="evenodd" /></svg>'
        : '<svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" /></svg>';
}

function updateProgress() {
    const progressPercent = (audio.currentTime / audio.duration) * 100;
    progress.style.width = `${progressPercent}%`;
    currentTimeElement.textContent = formatTime(audio.currentTime);
}

function seek(e) {
    const progressWidth = this.clientWidth;
    const clickX = e.offsetX;
    const duration = audio.duration;
    audio.currentTime = (clickX / progressWidth) * duration;
}

function formatTime(time) {
    const minutes = Math.floor(time / 60);
    const seconds = Math.floor(time % 60);
    return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
}

function toggleSlowedReverb() {
    slowedReverbEnabled = !slowedReverbEnabled;
    const toggle = document.querySelector('.lofi-toggle');
    const knob = document.querySelector('.lofi-toggle-knob');
    
    if (slowedReverbEnabled) {
        toggle.classList.add('active');
        knob.style.transform = 'translateX(24px)';
        applySlowedReverbEffect();
    } else {
        toggle.classList.remove('active');
        knob.style.transform = 'translateX(0)';
        removeSlowedReverbEffect();
    }
}

function applySlowedReverbEffect() {
    if (!audioContext) {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        sourceNode = audioContext.createMediaElementSource(audio);
    }

    // Reverb effect
    if (!reverbNode) {
        reverbNode = audioContext.createConvolver();
        const impulseLength = 1 * audioContext.sampleRate;
        const impulse = audioContext.createBuffer(2, impulseLength, audioContext.sampleRate);
        const left = impulse.getChannelData(0);
        const right = impulse.getChannelData(1);
        for (let i = 0; i < impulseLength; i++) {
            left[i] = right[i] = (Math.random() * 2 - 1) * Math.pow(1 - i / impulseLength, 2);
        }
        reverbNode.buffer = impulse;
    }

    const gainNode = audioContext.createGain();
    gainNode.gain.setValueAtTime(0.6, audioContext.currentTime); // Adjust this value to control the wet/dry mix

    // Slow down the audio (which also lowers the pitch)
    audio.preservesPitch = false;
    audio.playbackRate = 0.8; // Adjust this value to control the slowdown effect

    sourceNode.disconnect();
    sourceNode.connect(gainNode);
    gainNode.connect(audioContext.destination); // Dry signal
    sourceNode.connect(reverbNode);
    reverbNode.connect(audioContext.destination); // Wet signal
}

function removeSlowedReverbEffect() {
    audio.playbackRate = 1;
    audio.preservesPitch = true;

    if (sourceNode) {
        sourceNode.disconnect();
        if (reverbNode) {
            reverbNode.disconnect();
        }
        sourceNode.connect(audioContext.destination);
    }
}

function PlayAudio(audio_url, song_id) {
    var source = document.getElementById('audioSource');
    source.src = audio_url;
    var name = document.getElementById(song_id+"-n").textContent;
    var album = document.getElementById(song_id+"-a").textContent;
    var image = document.getElementById(song_id+"-i").getAttribute("src");
    
    document.title = name+" - "+album;
    document.getElementById("player-name").innerHTML = name;
    document.getElementById("player-album").innerHTML = album;
    document.getElementById("player-image").setAttribute("src",image);

    var promise = audio.load();
    if (promise) {
        promise.catch(function(error) { console.error(error); });
    }
    audio.play();
    updatePlayPauseButton(true);

    if (slowedReverbEnabled) {
        applySlowedReverbEffect();
    } else {
        removeSlowedReverbEffect();
    }
}
    </script>
</body>
</html>
